<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/sakura.css/css/sakura-pink.css"
      type="text/css"
    />
    <title>Get and receive robot data</title>
  </head>
  <body>
    <h1>FastAPI Testing</h1>
    
    <h2>Create Robot</h2>
    <label for="robot-name">Robot Name</label>
    <input type="text" name="robot-name" id="robot-name">
    <select name="weight-class" id="weight-class">
        <option value="ant">Antweight</option>
        <option value="plant">Plastic Ant</option>
        <option value="beetle">Beetleweight</option>
    </select>
    <button id="create-robot">Create Robot</button>

    <h2>Get All Robots</h2>
    <button id="get-robots">Get Robots</button>
    <table id="robots-table">
        <tr>
            <th>ID</th>
            <th>Display Name</th>
            <th>Name</th>
            <th>Weight Class</th>
        </tr>
    </table>
  </body>

  <script type="module">
    const createBtn = document.getElementById('create-robot');
    createBtn.addEventListener('click', () => {
        console.log(Date());
    })
  </script>


  <script type="module">
    const getRobotsBtn = document.getElementById("get-robots");
    const robotsTable = document.getElementById('robots-table');
    const robotsTableHeader = `<table id="robots-table">
        <tr>
            <th>ID</th>
            <th>Display Name</th>
            <th>Name</th>
            <th>Weight Class</th>
        </tr>
    </table>`

    getRobotsBtn.addEventListener("click", () => {
      fetch("/robots/")
        .then((response) => response.json())
        .then((data) => {
        //   console.table(data);
        robotsTable.innerHTML = robotsTableHeader;
          data.forEach((robot) => {
            let row = document.createElement("tr");
            [robot.id, robot.display_name, robot.name, robot.weight_class].forEach( detail => {
                let cell = document.createElement('td');
                console.log(cell);
                cell.innerText = detail;
                row.appendChild(cell);
            }); 
            robotsTable.appendChild(row);
          });
        });
    });
  </script>
</html>
